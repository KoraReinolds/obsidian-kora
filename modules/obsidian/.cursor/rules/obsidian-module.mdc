---
description: Obsidian module usage guide and patterns
globs: **/modules/obsidian/**/*
alwaysApply: false
---

# Obsidian Module - Essential Usage Guide

**USE THIS MODULE WHEN**: You need to interact with Obsidian vault, files, frontmatter, or create UI components.

## Core Classes & Functions

### VaultOperations
```typescript
import { VaultOperations } from './modules/obsidian';
const vaultOps = new VaultOperations(app);

// Essential methods:
await vaultOps.moveFileToFolder(file, targetFolder);
await vaultOps.getFileContent(file);
await vaultOps.createFile(path, content);
await vaultOps.openFile(file);
```

### FrontmatterUtils
```typescript
import { FrontmatterUtils } from './modules/obsidian';
const fm = new FrontmatterUtils(app);

// Single file operations:
await fm.getFrontmatter(file);
await fm.updateFrontmatter(file, { key: 'value' });
await fm.setFrontmatterField(file, 'field', 'value');

// Batch operations:
await fm.updateFrontmatterForFiles(filePaths, { key: 'value' });
await fm.getFrontmatterForFiles(filePaths);
```

### File Utilities
```typescript
import { getMarkdownFiles } from './modules/obsidian';

// Get TFile objects directly:
const files = getMarkdownFiles(app, { 
  include: ['Notes/**', '*.md'], 
  exclude: ['**/drafts/*'] 
});
```

### UI Components
```typescript
import { SuggesterFactory, TextInputSuggest } from './modules/obsidian';

// Ready-to-use suggesters:
const folderSuggester = SuggesterFactory.createFolderConfigSuggester(app, settings);
const channelSuggester = SuggesterFactory.createChannelSuggester(app, file, settings);

// Custom suggester:
const customSuggester = SuggesterFactory.createCustomSuggester(app, {
  placeholder: 'Choose...',
  dataSource: { getItems: () => myData, validateItems: (items) => items.length > 0 },
  display: { getTitle: (item) => item.name }
});

// Text input suggestions:
class MyInputSuggest extends TextInputSuggest<MyType> {
  getSuggestions(input: string) { /* filter logic */ }
  renderSuggestion(item: MyType, el: HTMLElement) { /* render logic */ }
  selectSuggestion(item: MyType) { /* selection logic */ }
}
```

## Key Patterns

1. **UNIVERSAL FILE ACCESS**: Use ONLY `getMarkdownFiles()` for all file operations
2. **Pattern-Based Filtering**: Use `include` and `exclude` with glob patterns for efficient filtering
3. **Single File Lookup**: Use `include: [fileName]` and get `files[0]` for specific file search
4. **Frontmatter**: Create one `FrontmatterUtils` instance and reuse it
5. **UI**: Use `SuggesterFactory` for consistent, reusable suggesters
6. **Error Handling**: Batch operations return detailed error information per file

## Common Use Cases

- **File Discovery**: Use `getMarkdownFiles()` with patterns for all file finding needs
- **File Management**: Moving, creating, reading files via VaultOperations
- **Metadata Operations**: Reading/updating frontmatter for single or multiple files
- **UI Components**: Creating suggesters, modals, input fields with autocomplete

## Important Notes

- **ONLY USE `getMarkdownFiles()`** - это единственный метод для получения файлов
- `getMarkdownFiles()` возвращает реальные `TFile` объекты для операций с контентом
- Все операции с файлами асинхронные - используйте `await`
- Используйте glob паттерны (`*`, `**`) для фильтрации файлов
- `SuggesterFactory` сокращает UI код на 80% по сравнению с ручной реализацией
- **НЕ создавайте собственные методы поиска файлов** - используйте встроенные параметры `getMarkdownFiles()`


- All file operations are async - use `await`
- Use glob patterns (`*`, `**`) for file filtering
- `SuggesterFactory` reduces UI code by 80% compared to manual implementation

